<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=gb2312">
<TITLE>无标题文档</TITLE>
<SCRIPT type="text/javascript">
function checkValue(){
	var username=document.myform.txtUser.value;
	var pass=document.myform.txtPass.value;
	var email=document.myform.txtEmail.value;
	if(username==""){
		alert("用户名不能为空");
		document.myform.txtUser.focus();
		return false;
	}else if(username.length<6||username.length>20){
		alert("用户名长度为6-20个字符");
		document.myform.txtUser.select();
		return false;
	}else{
	  for(var i=0;i<username.length;i++)
	  {
	     var charType=username.toUpperCase().charAt(i);
		 if( (!(charType>="0" && charType<="9")) &&  (!(charType>="A" && charType<="Z"))  && (charType!="_") )
		 {
		  alert("用户名包含非法字符，只能包括字母,数字和下划线");
		  document.myform.txtUser.select();
		  return false;
		  }
	  }
	}
	
	if(pass==""){
		alert("密码不能为空");
		document.myform.txtPass.focus();
		return false;
	}
	if(pass.length<6||pass.length>12){
		alert("密码长度为6-12个字符");
		document.myform.txtPass.select();
		return false;
	}

	var usersex = document.myform.sex;
	var count=0;
	for(i=0;i<usersex.length;i++){
		if(usersex[i].checked){
		count=1;
		break;
		}
	}
	if(count==0){
		alert("请选择性别");
		return false;
	}
	
	var birth=document.myform.txtBirth.value;
	if(birth==""){
		alert("请填写出生日期");
		return false;
	}else if(birth.length<10){
		alert("出生日期格式错误");
		return false;
	}else{
		var year=birth.substring(0,4);
		var month=birth.substring(5,7);
		var day=birth.substring(8,birth.length);
		if(birth.charAt(4)!="-"||birth.charAt(7)!="-"){
			alert("出生日期格式yyyy-mm-dd");
			return false;
		}
		if(isNaN(year)||isNaN(month)||isNaN(day)){
			alert("年月日必须是数字");
			return false;
		}
		var time=new Date();
		if(parseInt(year,10)<1900||parseInt(year,10)>time.getYear()){
			alert("出生日期范围从1900年-"+time.getYear()+"年");
			document.myform.txtBirth.select();
			return false;
		}else if(parseInt(month,10)<1||parseInt(month,10)>12){
			alert("您输入的月份不在1-12月之间");
			document.myform.txtBirth.select();
			return false;
		}else if(parseInt(day,10)<1||parseInt(day,10)>31){
			alert("您输入的天数不在1-31之间");
			document.myform.txtBirth.select();
			return false;
		}
		
	}
	
	var strEmail=document.myform.txtEmail;
	 if (strEmail.value.length==0)
	 {
	    alert("电子邮件不能为空!");
		strEmail.focus();
		return false;
	 }
     if (strEmail.value.indexOf("@",0)==-1||strEmail.value.indexOf(".",0)==-1)
	 {
	    alert("电子邮件格式不正确\n必须包含@和.符号！");
		strEmail.select();
		return false;
	 }else if(strEmail.value.charAt(0)=="@"||strEmail.value.charAt(0)=="."){
	 	alert("符号@和符号.不能在邮件地址第一位");
		strEmail.select();
		return false;
	 }else if(strEmail.value.charAt(strEmail.value.length-1)=="@"||strEmail.value.charAt(strEmail.value.length-1)=="."){
	 	alert("符号@和符号.不能在邮件地址最后一位");
		strEmail.select();
		return false;
	 }
	return true;
}

</SCRIPT>
</HEAD>

<BODY>
<FORM action="success.html" method="get" name="myform" onSubmit="return checkValue()">
<TABLE width="381" border="0" cellspacing="0" cellpadding="0" align="center" style="border:1px solid">
  <TR>
    <TD><IMG src="images/top.jpg"></TD>
    </TR>
	<TR><TD height="10">&nbsp;</TD></TR>
	 <TR>
    <TD height="175" align="center" valign="middle">
	<TABLE width="529" style="border:1px solid">
	 <TR>
    	<TD width="124">用户名：</TD>
		<TD width="393"><INPUT name="txtUser" type="text"><BR>
		包括字母,数字和下划线,长度6-20个字符</TD>
    </TR>
	<TR>
		<TD>密码：</TD>
    	<TD><INPUT name="txtPass" type="password">
    	密码长度6-12个字符</TD>
    </TR>
	<TR>
		<TD>性别：</TD>
    	<TD><INPUT name="sex" type="radio" value="male">
			  男<INPUT name="sex" type="radio" value="fmale">
			  女</TD>
    </TR>
		<TR>
    	<TD>出生日期:</TD>
		<TD>
		<INPUT name="txtBirth" type="text" size="10" maxlength="10">日期格式(yyyy-mm-dd)
		</TD>
    </TR>
	 <TR>
    	<TD>电子邮件地址:</TD>
		<TD><INPUT name="txtEmail" type="text">
		正确的Email地址</TD>
    </TR>

	<TR>
		<TD height="34" colspan="2" align="center"><INPUT name="submit" type="submit" value="同意以下条款并提交"></TD>
    	</TR>
	</TABLE> 
	</TD>
    </TR>
  <TR>
    <TD height="129"><IMG src="images/bottom.jpg"></TD>
    </TR>
</TABLE>


</FORM>
</BODY>
</HTML>
